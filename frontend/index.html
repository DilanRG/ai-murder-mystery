<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' http://127.0.0.1:*; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src https://fonts.gstatic.com;">
    <title>AI Murder Mystery</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Inter:wght@300;400;500;600&family=Crimson+Text:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <!-- Atmospheric background particles -->
    <div id="particles-bg"></div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TITLE SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="screen-title" class="screen active">
        <div class="title-content">
            <div class="title-ornament">‚öú</div>
            <h1 class="title-main">MURDER<br><span class="title-accent">MYSTERY</span></h1>
            <p class="title-subtitle">An AI-Driven Investigation</p>
            <div class="title-divider"></div>
            <button id="btn-new-game" class="btn btn-primary btn-glow">Begin Investigation</button>
            <button id="btn-settings" class="btn btn-ghost">‚öô Settings</button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETTINGS MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="modal-settings" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content glass-panel">
            <h2 class="modal-title">Configuration</h2>
            <div class="settings-form">
                <div class="form-group">
                    <label for="input-api-key">OpenRouter API Key</label>
                    <input type="password" id="input-api-key" class="input-field" placeholder="sk-or-v1-...">
                    <small>Get a free key at <a href="https://openrouter.ai" target="_blank">openrouter.ai</a></small>
                </div>
                <div class="form-group">
                    <label for="input-model">AI Model</label>
                    <select id="input-model" class="input-field">
                        <option value="openai/gpt-4o-mini">GPT-4o Mini (Fast & Affordable)</option>
                        <option value="openai/gpt-4o">GPT-4o (Best Quality)</option>
                        <option value="anthropic/claude-3.5-sonnet">Claude 3.5 Sonnet</option>
                        <option value="google/gemini-pro-1.5">Gemini Pro 1.5</option>
                        <option value="meta-llama/llama-3.1-70b-instruct">Llama 3.1 70B</option>
                    </select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="input-temperature">Temperature</label>
                        <input type="range" id="input-temperature" min="0" max="2" step="0.05" value="0.9">
                        <span id="temp-value" class="range-value">0.9</span>
                    </div>
                </div>
                <div class="form-actions">
                    <button id="btn-save-settings" class="btn btn-primary">Save</button>
                    <button id="btn-close-settings" class="btn btn-ghost">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SETUP SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="screen-setup" class="screen hidden">
        <div class="setup-content">
            <h2 class="section-title">Choose Your Role</h2>
            <p class="section-desc">Will you uncover the truth... or bury it deeper?</p>

            <div class="role-selection">
                <div class="role-card" data-role="detective" id="role-detective">
                    <div class="role-icon">üîç</div>
                    <h3>Detective</h3>
                    <p>Interrogate suspects, gather evidence, and expose the killer before it's too late.</p>
                </div>
                <div class="role-vs">VS</div>
                <div class="role-card" data-role="killer" id="role-killer">
                    <div class="role-icon">üó°Ô∏è</div>
                    <h3>Killer</h3>
                    <p>Deflect suspicion, manipulate witnesses, and escape justice by any means necessary.</p>
                </div>
            </div>

            <div class="player-setup hidden" id="player-setup">
                <div class="form-group">
                    <label for="input-player-name">Your Character Name</label>
                    <input type="text" id="input-player-name" class="input-field" placeholder="Enter a name..." value="Detective Gray">
                </div>
                <div class="form-group">
                    <label for="input-player-desc">Character Description <span class="optional">(optional)</span></label>
                    <textarea id="input-player-desc" class="input-field textarea" rows="3" placeholder="Describe your character's background and personality..."></textarea>
                </div>
                <button id="btn-start-game" class="btn btn-primary btn-glow btn-lg">
                    <span class="btn-text">Begin the Mystery</span>
                    <span class="btn-loading hidden">Generating Scenario...</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOADING SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="screen-loading" class="screen hidden">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h2 class="loading-title" id="loading-title">Crafting the Mystery</h2>
            <p class="loading-text" id="loading-text">The AI is weaving a web of intrigue and deception...</p>
            <div class="loading-bar">
                <div class="loading-bar-fill" id="loading-bar-fill"></div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê GAME SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="screen-game" class="screen hidden">
        <div class="game-layout">
            <!-- Left Sidebar: Location & Characters -->
            <aside class="game-sidebar sidebar-left">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">üìç Location</h3>
                    <div id="current-location" class="location-display">
                        <h4 id="location-name" class="location-name">‚Äî</h4>
                        <p id="location-desc" class="location-desc"></p>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">üó∫Ô∏è Move To</h3>
                    <div id="location-list" class="location-list"></div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">üë• Characters Here</h3>
                    <div id="characters-here" class="character-list"></div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">üìä Progress</h3>
                    <div id="game-progress" class="progress-display">
                        <div class="progress-item">
                            <span>Turn</span>
                            <span id="turn-counter">0 / 30</span>
                        </div>
                        <div class="progress-item">
                            <span>Clues</span>
                            <span id="clue-counter">0 / ?</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Center: Main Dialogue & Actions -->
            <main class="game-main">
                <div class="game-header">
                    <h2 id="scenario-title" class="scenario-title"></h2>
                    <div class="game-header-actions">
                        <button id="btn-accuse" class="btn btn-danger btn-sm" title="Make your accusation">‚öñ Accuse</button>
                    </div>
                </div>

                <div id="dialogue-panel" class="dialogue-panel">
                    <div id="dialogue-messages" class="dialogue-messages">
                        <!-- Messages will be appended here -->
                    </div>
                </div>

                <div class="action-bar">
                    <div class="action-input-row">
                        <input type="text" id="input-message" class="input-field input-message" placeholder="Say something to the NPC...">
                        <button id="btn-send" class="btn btn-primary btn-send" disabled>Send</button>
                    </div>
                    <div class="action-buttons">
                        <button id="btn-investigate" class="btn btn-outline btn-action" title="Search the current location">üîç Investigate</button>
                        <button id="btn-wait" class="btn btn-outline btn-action" title="Wait and observe">‚è≥ Wait</button>
                    </div>
                </div>
            </main>

            <!-- Right Sidebar: Clue Journal -->
            <aside class="game-sidebar sidebar-right">
                <div class="sidebar-section">
                    <h3 class="sidebar-title">üìã Clue Journal</h3>
                    <div id="clue-journal" class="clue-journal">
                        <p class="journal-empty">No clues discovered yet. Start investigating!</p>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3 class="sidebar-title">üì∞ Event Log</h3>
                    <div id="event-log" class="event-log">
                        <p class="log-empty">The investigation begins...</p>
                    </div>
                </div>
            </aside>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ACCUSATION MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="modal-accuse" class="modal hidden">
        <div class="modal-backdrop"></div>
        <div class="modal-content glass-panel">
            <h2 class="modal-title">‚öñ Make Your Accusation</h2>
            <p class="modal-desc">Choose carefully ‚Äî this will end the game.</p>
            <div class="form-group">
                <label for="select-suspect">Who is the killer?</label>
                <select id="select-suspect" class="input-field"></select>
            </div>
            <div class="form-group">
                <label for="input-reasoning">Your reasoning <span class="optional">(optional)</span></label>
                <textarea id="input-reasoning" class="input-field textarea" rows="3" placeholder="Explain your deduction..."></textarea>
            </div>
            <div class="form-actions">
                <button id="btn-confirm-accuse" class="btn btn-danger">Confirm Accusation</button>
                <button id="btn-cancel-accuse" class="btn btn-ghost">Go Back</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RESULTS SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="screen-results" class="screen hidden">
        <div class="results-content">
            <div id="results-icon" class="results-icon">üèÜ</div>
            <h2 id="results-title" class="results-title">Case Closed</h2>
            <div id="results-narrative" class="results-narrative"></div>
            <div id="results-stats" class="results-stats"></div>
            <button id="btn-play-again" class="btn btn-primary btn-glow">Play Again</button>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>
